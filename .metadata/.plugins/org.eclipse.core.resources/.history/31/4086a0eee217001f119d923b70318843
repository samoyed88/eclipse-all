package _21point;
import java.util.*;


public class final_project {

	public static void main(String[] args) {
		Scanner sc=new Scanner(System.in);
		//使用arrayList建立一副牌
		ArrayList<String> poker=new ArrayList<String>();
		creatpoker(poker);
		String input;
		int players;
		List<player> numplayer = new ArrayList<>();
		//開始遊戲
		do {
			System.out.println("21點遊戲，請輸入start開始遊戲");
			input=sc.next().toLowerCase();
		}while(!(input.equalsIgnoreCase("start")));
		//遊玩人數設定
		System.out.println("請輸入遊玩人數(1-4)");
		input=sc.next();
		while(!(input.matches("[1-4]"))) {
			System.out.println("輸入錯誤請重新輸入");
			System.out.println("請輸入遊玩人數");
			input=sc.next();
		}
		players=Integer.parseInt(input);
		//建立玩家物件 numplayer.get(0)為莊家
		for(int i=0;i<=players;i++) {
			numplayer.add(new player());
		}
		int count=1;
		do {
			System.out.println("第"+(count++)+"輪");
			for(int i=1;i<numplayer.size();i++) {
				System.out.print("第"+i+"位玩家");
				int num=drawcard(poker);
				if(num==1) {
					do {
						System.out.println("抽到1，選擇1請輸入a，選擇11請輸入b");
						input=sc.next();
						if(input.equalsIgnoreCase("a")) {
							numplayer.get(i).numadd(1);
						}
						else if(input.equalsIgnoreCase("b")) {
							numplayer.get(i).numadd(11);
						}
						else System.out.println("輸入錯誤，請重新輸入");
					}while(!input.equalsIgnoreCase("a")&&!input.equalsIgnoreCase("b"));
				}
				else numplayer.get(i).numadd(num);
			}
			System.out.println();
			System.out.println("第"+(count++)+"輪");
			for(int i=1;i<numplayer.size();i++) {
				System.out.print("第"+i+"位玩家");
				int num=drawcard(poker);
				if(num==1) {
					do {
						System.out.println("抽到1，選擇1請輸入a，選擇11請輸入b");
						input=sc.next();
						if(input.equalsIgnoreCase("a")) {
							numplayer.get(i).numadd(1);
						}
						else if(input.equalsIgnoreCase("b")) {
							numplayer.get(i).numadd(11);
						}
						else System.out.println("輸入錯誤，請重新輸入");
					}while(!input.equalsIgnoreCase("a")&&!input.equalsIgnoreCase("b"));
				}
				else numplayer.get(i).numadd(num);
				
				//numplayer.get(i).numadd(drawcard(poker));
			}
			for(int i=1;i<numplayer.size();i++) {
				do {
					if(numplayer.get(i).getnum()>21) {
						System.out.println("玩家"+i+"爆掉了!");
						break;
					}
					System.out.print("\r\n玩家"+i+"目前點數為"+numplayer.get(i).getnum());
					System.out.println("是否繼續抽牌(輸入t抽牌，輸入f不抽牌");
					input=sc.next();
					if(input.equalsIgnoreCase("t")) {
						numplayer.get(i).numadd(drawcard(poker));
					}
					else if(input.equalsIgnoreCase("f")) {
						System.out.println("結束抽牌");
					}
					else System.out.println("輸入錯誤，請重新輸入");
				}while(!input.equalsIgnoreCase("f"));
			}
			System.out.println("莊家");
			numplayer.get(0).numadd(drawcard(poker));
			numplayer.get(0).numadd(drawcard(poker));
			if(numplayer.get(0).getnum()<15) {
				numplayer.get(0).numadd(drawcard(poker));
			}
			System.out.println("莊家點數："+numplayer.get(0).getnum());
			
			
			
			
			
		}while(!poker.isEmpty());
		/*
		int count0=1,count1=3;
		do {
			//莊家抽牌
			System.out.print("\r\n莊家第1張牌:");
			if(!drawcard(numplayer,poker,0)) {
				break;
			}
			System.out.print("莊家第2張牌：");
			if(!drawcard(numplayer,poker,0)) {
				break;
			}
			int n=3;
			while(numplayer.get(0).getnum()<=15){
				System.out.print("莊家第"+(n++)+"張牌：");
				if(!drawcard(numplayer,poker,0)) {
					break;
				}
			}
			System.out.println();
			System.out.println("莊家點數:"+numplayer.get(0).getnum());
			System.out.println();
			//玩家抽牌
			count1=1;
			System.out.println("玩家第"+(count0)+"輪第"+(count1++)+"次抽卡");
			drawcard(poker);
			System.out.println("\r\n玩家第"+(count0)+"輪第"+(count1++)+"次抽卡");
			if(!drawcard(numplayer,poker)) {
				break;
			}
			
			for(int i=1;i<numplayer.size();i++) {
				do {
					if(numplayer.get(i).getnum()>21) {
						System.out.println("玩家"+i+"爆掉了!");
						break;
					}
					System.out.print("\r\n玩家"+i+"目前點數為"+numplayer.get(i).getnum());
					System.out.println("  莊家為:"+numplayer.get(0).getnum());
					System.out.println("是否繼續抽牌(輸入t抽牌，輸入f不抽牌");
					input=sc.next();
					if(input.equalsIgnoreCase("t")) {
						System.out.print("此張牌為：");
						if(!drawcard(numplayer,poker,i)) {
							break;
						}
					}
					else if(input.equalsIgnoreCase("f")) {
						System.out.println("已跳過");			
					}
					else System.out.println("輸入錯誤，請重新輸入");
				}while(!input.equalsIgnoreCase("f"));
				numplayer.get(i).scorecal(numplayer.get(0).getnum());
				System.out.println("\r\n玩家"+i+"目前分數為："+numplayer.get(i).getscore());
			}
			for(int i=0;i<numplayer.size();i++) {
				numplayer.get(i).numreturn();
			}
			count0++;
		}while(!(poker[0].isEmpty() && poker[1].isEmpty() && poker[2].isEmpty() && poker[3].isEmpty()));
		System.out.println("沒牌了~遊戲結束，玩家分數如下：");
		for(int i=1;i<numplayer.size();i++) {
			System.out.println("玩家"+i+":"+numplayer.get(i).getscore());
		}
		*/
		sc.close();
	}
	//poker[i]陣列的i=0為梅花 i=1為菱形 i=2為紅心 i=3為黑桃 各有1~13
	public static void creatpoker(ArrayList<String> poker){
		for(int i=1;i<=10;i++) {
			poker.add("C-"+i);
		}
		poker.add("C-J");
		poker.add("C-Q");
		poker.add("C-K");
		for(int i=1;i<=10;i++) {
			poker.add("D-"+i);
		}
		poker.add("D-J");
		poker.add("D-Q");
		poker.add("D-K");
		for(int i=1;i<=10;i++) {
			poker.add("H-"+i);
		}
		poker.add("H-J");
		poker.add("H-Q");
		poker.add("H-K");
		for(int i=1;i<=10;i++) {
			poker.add("S-"+i);
		}
		poker.add("S-J");
		poker.add("S-Q");
		poker.add("S-K");
	}
	
	//抽單張
	public static int drawcard(ArrayList<String> poker) {
		int random=(int)(Math.random()*poker.size());
		String card=poker.get(random);
		System.out.println("抽到:"+card);
		int num=0;
		if(card.charAt(2)=='1'&& card.charAt(3)=='0') {
			num=10;
		}
		else if(card.charAt(2)=='J') {
			num=10;
		}
		else if(card.charAt(2)=='Q') {
			num=10;
		}
		else if(card.charAt(2)=='K') {
			num=10;
		}
		else num=Integer.parseInt(String.valueOf(card.charAt(2)));
		poker.remove(random);
		return num;
	}
}
